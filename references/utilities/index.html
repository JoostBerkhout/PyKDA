
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../loaders/">
      
      
        <link rel="next" href="../constants/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.13">
    
    
      
        <title>Utilities - PyKDA</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e359304.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pykda.utilities" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="PyKDA" class="md-header__button md-logo" aria-label="PyKDA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyKDA
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Utilities
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PyKDA" class="md-nav__button md-logo" aria-label="PyKDA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    PyKDA
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation instructions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Markov_chain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markov chain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../KDA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    KDA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../normalizers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Normalizers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../loaders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Loaders
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Utilities
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Utilities
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities" class="md-nav__link">
    <span class="md-ellipsis">
      utilities
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.Euclidean_distances" class="md-nav__link">
    <span class="md-ellipsis">
      Euclidean_distances
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.Gaussian_similarity" class="md-nav__link">
    <span class="md-ellipsis">
      Gaussian_similarity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.create_graph_dict" class="md-nav__link">
    <span class="md-ellipsis">
      create_graph_dict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.eigenvec_centrality" class="md-nav__link">
    <span class="md-ellipsis">
      eigenvec_centrality
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.expand_matrix_with_row_and_column" class="md-nav__link">
    <span class="md-ellipsis">
      expand_matrix_with_row_and_column
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.has_positive_row_sums" class="md-nav__link">
    <span class="md-ellipsis">
      has_positive_row_sums
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.is_nonnegative_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      is_nonnegative_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.is_stochastic_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      is_stochastic_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.perturb_stochastic_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      perturb_stochastic_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.row_sums_are_1" class="md-nav__link">
    <span class="md-ellipsis">
      row_sums_are_1
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constants/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constants
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities" class="md-nav__link">
    <span class="md-ellipsis">
      utilities
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.Euclidean_distances" class="md-nav__link">
    <span class="md-ellipsis">
      Euclidean_distances
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.Gaussian_similarity" class="md-nav__link">
    <span class="md-ellipsis">
      Gaussian_similarity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.create_graph_dict" class="md-nav__link">
    <span class="md-ellipsis">
      create_graph_dict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.eigenvec_centrality" class="md-nav__link">
    <span class="md-ellipsis">
      eigenvec_centrality
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.expand_matrix_with_row_and_column" class="md-nav__link">
    <span class="md-ellipsis">
      expand_matrix_with_row_and_column
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.has_positive_row_sums" class="md-nav__link">
    <span class="md-ellipsis">
      has_positive_row_sums
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.is_nonnegative_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      is_nonnegative_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.is_stochastic_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      is_stochastic_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.perturb_stochastic_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      perturb_stochastic_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pykda.utilities.row_sums_are_1" class="md-nav__link">
    <span class="md-ellipsis">
      row_sums_are_1
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Utilities</h1>

<div class="doc doc-object doc-module">



<a id="pykda.utilities"></a>
  <div class="doc doc-contents first">
  
      <p>Contains general utility functions for the package.</p>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="pykda.utilities.Euclidean_distances" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">Euclidean_distances</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Calculate the Euclidian distances between the rows of a data array.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>data</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>)
        –
        <div class="doc-md-description">
          <p>Array in which the rows represent data points.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        –
        <div class="doc-md-description">
          <p>Matrix with Euclidian distances between the rows of the data input.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>pykda\utilities.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">Euclidean_distances</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the Euclidian distances between the rows of a data array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : np.ndarray</span>
<span class="sd">        Array in which the rows represent data points.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        Matrix with Euclidian distances between the rows of the data input.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">data</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="pykda.utilities.Gaussian_similarity" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">Gaussian_similarity</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Calculate the Gaussian similarity function between the rows of an array.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>data</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>)
        –
        <div class="doc-md-description">
          <p>Array in which the rows represent data points.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>scale</code></b>
            (<code>float</code>, default:
                <code>1</code>
)
        –
        <div class="doc-md-description">
          <p>The variance of the data points is scaled by this value. Larger values
of scale means smaller data neighborhoods, and vice versa. Default is
6.5, which is taken from Berkhout and Heidergott (2019).</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        –
        <div class="doc-md-description">
          <p>Array of Gaussian similarity function values between the data rows.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>pykda\utilities.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">Gaussian_similarity</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the Gaussian similarity function between the rows of an array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : np.ndarray</span>
<span class="sd">        Array in which the rows represent data points.</span>
<span class="sd">    scale: float</span>
<span class="sd">        The variance of the data points is scaled by this value. Larger values</span>
<span class="sd">        of scale means smaller data neighborhoods, and vice versa. Default is</span>
<span class="sd">        6.5, which is taken from Berkhout and Heidergott (2019).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        Array of Gaussian similarity function values between the data rows.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">distances</span> <span class="o">=</span> <span class="n">Euclidean_distances</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">data</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="p">)</span>
    <span class="n">scaled_variance</span> <span class="o">=</span> <span class="n">var</span> <span class="o">/</span> <span class="n">scale</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">distances</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">scaled_variance</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="pykda.utilities.create_graph_dict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">create_graph_dict</span><span class="p">(</span><span class="n">A</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a graph dictionary based upon adjacency matrix A, where each
(i, j) for which A(i, j) &gt; 0 is an edge by assumption.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>A</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>)
        –
        <div class="doc-md-description">
          <p>An adjacency matrix.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
<b><code>graph</code></b> (            <code>dict</code>
)        –
        <div class="doc-md-description">
          <p>graph[i] gives a list of nodes that can be reached from node i.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>pykda\utilities.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_graph_dict</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a graph dictionary based upon adjacency matrix A, where each</span>
<span class="sd">    (i, j) for which A(i, j) &gt; 0 is an edge by assumption.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    A : np.ndarray</span>
<span class="sd">        An adjacency matrix.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    graph : dict</span>
<span class="sd">        graph[i] gives a list of nodes that can be reached from node i.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="n">i</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">VALUE_ZERO</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="pykda.utilities.eigenvec_centrality" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">eigenvec_centrality</span><span class="p">(</span><span class="n">A</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Compute the eigenvector centrality of a given non-negative adjacency matrix.</p>
<p>I am assuming the matrix A contains one connected component.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>A</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>)
        –
        <div class="doc-md-description">
          <p>Adjacency matrix to calculate the eigenvector centrality of.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        –
        <div class="doc-md-description">
          <p>The eigenvector centrality of A.</p>
      </div>
      </li>
      <li class="field-body">
            <code>float</code>
        –
        <div class="doc-md-description">
          <p>The eigenvector centrality of A.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>pykda\utilities.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">eigenvec_centrality</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the eigenvector centrality of a given non-negative adjacency matrix.</span>

<span class="sd">    I am assuming the matrix A contains one connected component.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    A : np.ndarray</span>
<span class="sd">        Adjacency matrix to calculate the eigenvector centrality of.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        The eigenvector centrality of A.</span>
<span class="sd">    float</span>
<span class="sd">        The eigenvector centrality of A.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">assert</span> <span class="n">is_nonnegative_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="s2">&quot;Ensure the matrix elements are &gt;= 0.&quot;</span>

    <span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">max_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">eigenvectors</span><span class="p">[:,</span> <span class="p">[</span><span class="n">max_idx</span><span class="p">]],</span> <span class="n">eigenvalues</span><span class="p">[</span><span class="n">max_idx</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="pykda.utilities.expand_matrix_with_row_and_column" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">expand_matrix_with_row_and_column</span><span class="p">(</span><span class="n">A</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Expands the given matrix with an extra row and column of zeros at the start.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>A</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>)
        –
        <div class="doc-md-description">
          <p>Matrix to which to add first row and column.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        –
        <div class="doc-md-description">
          <p>A where a first row and column of zeros is added at the start.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>pykda\utilities.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">expand_matrix_with_row_and_column</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Expands the given matrix with an extra row and column of zeros at the start.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    A : np.ndarray</span>
<span class="sd">        Matrix to which to add first row and column.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        A where a first row and column of zeros is added at the start.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">extra_column</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">extra_column</span><span class="p">,</span> <span class="n">A</span><span class="p">])</span>
    <span class="n">extra_row</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">extra_row</span><span class="p">,</span> <span class="n">A</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="pykda.utilities.has_positive_row_sums" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">has_positive_row_sums</span><span class="p">(</span><span class="n">A</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Check if the row sums of a given matrix are positive.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>A</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>)
        –
        <div class="doc-md-description">
          <p>Matrix to be checked.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>bool</code>
        –
        <div class="doc-md-description">
          <p>True if the row sums of A are positive, False otherwise.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>pykda\utilities.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">has_positive_row_sums</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bool_</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the row sums of a given matrix are positive.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    A : np.ndarray</span>
<span class="sd">        Matrix to be checked.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        True if the row sums of A are positive, False otherwise.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">VALUE_ZERO</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="pykda.utilities.is_nonnegative_matrix" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">is_nonnegative_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Check if a given matrix is non-negative.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>A</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>)
        –
        <div class="doc-md-description">
          <p>Matrix to be checked.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>bool</code>
        –
        <div class="doc-md-description">
          <p>True if A is non-negative, False otherwise.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>pykda\utilities.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_nonnegative_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bool_</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if a given matrix is non-negative.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    A : np.ndarray</span>
<span class="sd">        Matrix to be checked.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        True if A is non-negative, False otherwise.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">A</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="pykda.utilities.is_stochastic_matrix" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">is_stochastic_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Check if a given matrix is a stochastic matrix.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>A</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>)
        –
        <div class="doc-md-description">
          <p>Matrix to be checked.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>bool</code>
        –
        <div class="doc-md-description">
          <p>True if P is a stochastic matrix, False otherwise.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>pykda\utilities.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_stochastic_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if a given matrix is a stochastic matrix.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    A : np.ndarray</span>
<span class="sd">        Matrix to be checked.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        True if P is a stochastic matrix, False otherwise.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">is_nonnegative_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="ow">and</span> <span class="n">row_sums_are_1</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="pykda.utilities.perturb_stochastic_matrix" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">perturb_stochastic_matrix</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mi">10</span> <span class="o">**</span> <span class="o">-</span><span class="mi">4</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Perturbes P towards (i, j) with rate theta according to the method
from Berkhout and Heidergott (2019) "Analysis of Markov influence graphs".</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>P</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>)
        –
        <div class="doc-md-description">
          <p>An adjacency matrix.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>i</code></b>
            (<code>int</code>)
        –
        <div class="doc-md-description">
          <p>The row index of the perturbation.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>j</code></b>
            (<code>int</code>)
        –
        <div class="doc-md-description">
          <p>The column index of the perturbation.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>theta</code></b>
            (<code>float</code>, default:
                <code>10 ** -4</code>
)
        –
        <div class="doc-md-description">
          <p>The perturbation parameter.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        –
        <div class="doc-md-description">
          <p>P perturbed into the direction of (i, j) with rate theta.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>pykda\utilities.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">perturb_stochastic_matrix</span><span class="p">(</span>
    <span class="n">P</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perturbes P towards (i, j) with rate theta according to the method</span>
<span class="sd">    from Berkhout and Heidergott (2019) &quot;Analysis of Markov influence graphs&quot;.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    P : np.ndarray</span>
<span class="sd">        An adjacency matrix.</span>
<span class="sd">    i : int</span>
<span class="sd">        The row index of the perturbation.</span>
<span class="sd">    j : int</span>
<span class="sd">        The column index of the perturbation.</span>
<span class="sd">    theta : float</span>
<span class="sd">        The perturbation parameter.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        P perturbed into the direction of (i, j) with rate theta.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">P_perturbed</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">P_perturbed</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">theta</span>
    <span class="n">P_perturbed</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">theta</span>

    <span class="k">return</span> <span class="n">P_perturbed</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="pykda.utilities.row_sums_are_1" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">row_sums_are_1</span><span class="p">(</span><span class="n">A</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Check if the row sums of a given matrix are equal to one.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>A</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>)
        –
        <div class="doc-md-description">
          <p>Matrix to be checked.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>bool</code>
        –
        <div class="doc-md-description">
          <p>True if the row sums of A are equal to one, False otherwise.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>pykda\utilities.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">row_sums_are_1</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the row sums of a given matrix are equal to one.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    A : np.ndarray</span>
<span class="sd">        Matrix to be checked.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        True if the row sums of A are equal to one, False otherwise.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">VALUE_ZERO</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="mailto:<joost.berkhout@vu.nl>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.7l167.6-182.9c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/JoostBerkhout/PyKDA" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8d2eff1.min.js"></script>
      
    
  </body>
</html>